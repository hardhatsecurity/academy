<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Operation Winter Storm — HardHat Security</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg:      #0d1117;
    --panel:   #161c26;
    --border:  #2a3548;
    --accent:  #b44fff;
    --accent2: #ff4d72;
    --text:    #c9d8eb;
    --dim:     #6b7f96;
    --bright:  #f0f6ff;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Inter', sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 24px;
  }

  /* Subtle grid */
  body::before {
    content: '';
    position: fixed; inset: 0; z-index: 0;
    background-image:
      linear-gradient(rgba(180,79,255,0.05) 1px, transparent 1px),
      linear-gradient(90deg, rgba(180,79,255,0.05) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
  }

  .container {
    position: relative; z-index: 1;
    width: 100%; max-width: 440px;
    text-align: center;
  }

  .brand-eyebrow {
    font-size: 11px;
    letter-spacing: 6px;
    color: var(--accent2);
    text-transform: uppercase;
    margin-bottom: 16px;
    opacity: 0;
    animation: fadeUp .6s ease .1s forwards;
  }

  .brand-name {
    font-family: 'Orbitron', sans-serif;
    font-size: clamp(28px, 6vw, 48px);
    font-weight: 900;
    color: var(--bright);
    letter-spacing: 3px;
    line-height: 1.1;
    margin-bottom: 6px;
    opacity: 0;
    animation: fadeUp .6s ease .2s forwards;
  }

  .brand-name span { color: var(--accent); }

  .brand-sub {
    font-size: 13px;
    color: var(--dim);
    letter-spacing: 2px;
    margin-bottom: 48px;
    opacity: 0;
    animation: fadeUp .6s ease .3s forwards;
  }

  .card {
    background: var(--panel);
    border: 1px solid var(--border);
    padding: 36px 32px;
    opacity: 0;
    animation: fadeUp .6s ease .4s forwards;
  }

  .card-label {
    font-family: 'Orbitron', sans-serif;
    font-size: 10px;
    letter-spacing: 4px;
    color: var(--accent);
    text-transform: uppercase;
    margin-bottom: 24px;
  }

  input[type="text"], input[type="password"] {
    width: 100%;
    padding: 14px 18px;
    background: var(--bg);
    border: 1px solid var(--border);
    color: var(--bright);
    font-family: 'Inter', monospace;
    font-size: 15px;
    text-align: center;
    letter-spacing: 3px;
    outline: none;
    transition: border-color .2s;
    margin-bottom: 12px;
  }
  input:focus { border-color: var(--accent); }

  .btn {
    width: 100%;
    padding: 15px;
    background: transparent;
    border: 1px solid var(--accent);
    color: var(--accent);
    font-family: 'Orbitron', sans-serif;
    font-size: 12px;
    letter-spacing: 5px;
    text-transform: uppercase;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: color .25s;
  }
  .btn::before {
    content: '';
    position: absolute; inset: 0;
    background: var(--accent);
    transform: translateX(-100%);
    transition: transform .25s;
  }
  .btn:hover { color: var(--bg); }
  .btn:hover::before { transform: translateX(0); }
  .btn span { position: relative; z-index: 1; }
  .btn:disabled { opacity: .5; cursor: not-allowed; }
  .btn:disabled::before { display: none; }

  #error-msg {
    margin-top: 14px;
    font-size: 13px;
    color: var(--accent2);
    letter-spacing: 1px;
    min-height: 20px;
    opacity: 0;
    transition: opacity .3s;
  }
  #error-msg.show { opacity: 1; }

  .footer-note {
    margin-top: 40px;
    font-size: 12px;
    color: var(--dim);
    line-height: 1.8;
    opacity: 0;
    animation: fadeUp .6s ease .5s forwards;
  }
  .footer-note a {
    color: var(--accent);
    text-decoration: none;
  }

  /* Loading overlay */
  #loading {
    display: none;
    position: fixed; inset: 0; z-index: 999;
    background: var(--bg);
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 20px;
  }
  #loading.show { display: flex; }

  .spinner {
    width: 40px; height: 40px;
    border: 3px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin .8s linear infinite;
  }

  .loading-text {
    font-family: 'Orbitron', sans-serif;
    font-size: 12px;
    letter-spacing: 4px;
    color: var(--dim);
  }

  @keyframes spin    { to { transform: rotate(360deg); } }
  @keyframes fadeUp  { from { opacity:0; transform:translateY(16px); } to { opacity:1; transform:translateY(0); } }
</style>
</head>
<body>

<!-- Loading overlay -->
<div id="loading">
  <div class="spinner"></div>
  <div class="loading-text">DECRYPTING SIMULATION…</div>
</div>

<div class="container">
  <div class="brand-eyebrow">Adversary Emulation Platform</div>
  <div class="brand-name">HARDHAT<br><span>SECURITY</span></div>
  <div class="brand-sub">hardhatsecurity.com</div>

  <div class="card">
    <div class="card-label">Operation Winter Storm</div>

    <input
      id="token-input"
      type="password"
      placeholder="Enter access key"
      autocomplete="off"
      spellcheck="false" />

    <button class="btn" id="go-btn" onclick="launch()">
      <span>Launch Simulation →</span>
    </button>

    <div id="error-msg"></div>
  </div>

  <div class="footer-note">
    Don't have a key?
    <a href="mailto:hello@hardhatsecurity.com">Request access →</a>
  </div>
</div>

<script>
  // ── Config — update WORKER_URL after deploying your worker
  const WORKER_URL = 'https://hardhat-winter-storm.hardhatsecurity.workers.dev';

  const input   = document.getElementById('token-input');
  const btn     = document.getElementById('go-btn');
  const errMsg  = document.getElementById('error-msg');
  const loading = document.getElementById('loading');

  input.addEventListener('keydown', e => { if (e.key === 'Enter') launch(); });

  function showError(msg) {
    errMsg.textContent = '✗  ' + msg;
    errMsg.classList.add('show');
    btn.disabled = false;
    btn.querySelector('span').textContent = 'Launch Simulation →';
  }

  async function launch() {
    const token = input.value.trim();
    if (!token) { showError('Enter your access key.'); return; }

    errMsg.classList.remove('show');
    btn.disabled = true;
    btn.querySelector('span').textContent = 'Authenticating…';

    try {
      const res = await fetch(`${WORKER_URL}/sim/winter-storm`, {
        method: 'GET',
        headers: { 'Authorization': `Bearer ${token}` },
      });

      if (res.status === 401 || res.status === 403) {
        showError('Invalid key — access denied.');
        return;
      }
      if (res.status === 429) {
        const data = await res.json().catch(() => ({}));
        showError(data.error || 'Too many attempts. Try again later.');
        return;
      }
      if (!res.ok) {
        showError(`Server error (${res.status}). Try again.`);
        return;
      }

      // Got the HTML — replace current page
      loading.classList.add('show');
      const html = await res.text();

      // Write the simulation into the current page
      document.open();
      document.write(html);
      document.close();

    } catch (err) {
      showError('Could not reach the server. Check your connection.');
      console.error(err);
    }
  }
</script>
</body>
</html>
